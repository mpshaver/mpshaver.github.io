<!DOCTYPE html>
<html lang="en">

<head>
	<meta charset="UTF-8" />
	<meta name="viewport" content="width=device-width, initial-scale=1.0" />
	<title>Livestream Countdown</title>
	<style>
		body {
			font-family: 'Times New Roman', Times, serif, sans-serif;
			background: #efefef;
			color: #343A40;
			text-align: center;
			padding: 2rem;
		}

		h1 {
			font-size: 3rem;
			margin-bottom: 1rem;
		}

		#countdown {
			font-size: 4rem;
			font-weight: bold;
			margin-bottom: 2rem;
		}

		#livestream-container {
			display: none;
		}

		.video-wrapper {
			position: relative;
			width: 80%;
			max-width: 960px;
			margin: 0 auto 2rem;
			padding-bottom: 56.25%;
			height: 0;
		}

		.video-wrapper iframe {
			position: absolute;
			top: 0;
			left: 0;
			width: 100%;
			height: 100%;
			border: none;
		}
	</style>
</head>

<body>

	<h1>Next Livestream Starts In:</h1>
	<div id="countdown">Loading...</div>

	<div id="livestream-container">
		<p id="live-message"><strong>We’ll be live shortly…</strong></p>
		<div class="video-wrapper">
			<iframe src="https://www.youtube.com/embed/live_stream?channel=UC1NkuQJFFiZ8gP5jRM9W_TQ&amp;enablejsapi=1&amp;autoplay=1&amp;showinfo=0&amp;controls=0" allow="autoplay; encrypted-media" allowfullscreen title="YouTube livestream"></iframe>
		</div>
	</div>

	<div id="latest-video"></div>

	<script>
		function getNextSundayAt9AM_UTC() {
			const now = new Date();
			const target = new Date(Date.UTC(
				now.getUTCFullYear(),
				now.getUTCMonth(),
				now.getUTCDate(),
				14, 0, 0 // 14:00 UTC = 9:00 AM ET
			));

			const day = now.getUTCDay();
			if (day > 0 || now >= target) {
				const daysUntilSunday = (7 - day) % 7;
				target.setUTCDate(target.getUTCDate() + daysUntilSunday);
			}

			return target;
		}

		function updateCountdown() {
			const now = new Date();
			const target = getNextSundayAt9AM_UTC();
			const diff = target - now;

			const countdownEl = document.getElementById("countdown");
			const streamEl = document.getElementById("livestream-container");
			const messageEl = document.getElementById("live-message");

			if (now.getUTCDay() === 0 && now.getUTCHours() >= 14) {
				countdownEl.style.display = "none";
				streamEl.style.display = "block";
				messageEl.style.display = "none";
			} else if (now.getDay() === 1 && now.getHours() === 0) {
				countdownEl.style.display = "block";
				streamEl.style.display = "none";
				messageEl.style.display = "block";
			} else {
				countdownEl.style.display = "block";
				streamEl.style.display = "none";
				messageEl.style.display = "block";

				const seconds = Math.floor(diff / 1000) % 60;
				const minutes = Math.floor(diff / (1000 * 60)) % 60;
				const hours = Math.floor(diff / (1000 * 60 * 60)) % 24;
				const days = Math.floor(diff / (1000 * 60 * 60 * 24));

				countdownEl.textContent = `${days}d ${hours}h ${minutes}m ${seconds}s`;
			}
		}

		updateCountdown();
		setInterval(updateCountdown, 1000);

		// Load latest video
		const feedUrl = 'https://www.youtube.com/feeds/videos.xml?channel_id=UC1NkuQJFFiZ8gP5jRM9W_TQ';
		fetch('https://api.rss2json.com/v1/api.json?rss_url=' + encodeURIComponent(feedUrl))
			.then(response => response.json())
			.then(data => {
				const videoId = data.items[0].link.split('v=')[1];
				const wrapper = document.createElement('div');
				wrapper.className = 'video-wrapper';
				const iframe = document.createElement('iframe');
				iframe.src = `https://www.youtube.com/embed/${videoId}`;
				iframe.allow = "accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture";
				iframe.allowFullscreen = true;
				iframe.title = "Latest YouTube Video";
				wrapper.appendChild(iframe);
				document.getElementById('latest-video').appendChild(wrapper);
			});
	</script>

</body>

</html>
